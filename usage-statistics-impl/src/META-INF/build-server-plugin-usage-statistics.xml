<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Copyright 2000-2011 JetBrains s.r.o.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans default-autowire="constructor">

  <!-- Web -->

  <bean id="usageStatisticsController" class="jetbrains.buildServer.controllers.UsageStatisticsController"/>
  <bean id="downloadUsageStatisticsController" class="jetbrains.buildServer.controllers.DownloadUsageStatisticsController"/>

  <!-- Core -->

  <bean id="usageStatisticsManager" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsCollectorImpl"/>
  <bean id="usageStatisticsReporter" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsReporterImpl"/>
  <bean id="usageStatisticsReportingScheduler" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsReportingScheduler"/>
  <bean id="usageStatisticsSettingsPersistor" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsSettingsPersistor"/>
  <bean id="usageStatisticsCommonDataPersistor" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsCommonDataPersistor"/>
  <bean id="usageStatisticsLicenseAgreementListener" class="jetbrains.buildServer.usageStatistics.impl.UsageStatisticsLicenseAgreementListener">
    <constructor-arg index="3" ref="licenseAgreementDispatcher"/>
  </bean>

  <!-- Providers -->

  <bean id="buildDataUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.BuildDataUsageStatisticsProvider">
    <property name="idFormat" value="jb.%s.%s"/>
    <property name="groupName" value="Builds"/>
  </bean>

  <bean id="staticServerUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.StaticServerUsageStatisticsProvider">
    <property name="idFormat" value="jb.%s"/>
    <property name="groupName" value="General (total count)"/>
  </bean>

  <bean id="ideUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.IDEUsageStatisticsProvider">
    <constructor-arg index="2" ref="xmlRpcDispatcher"/>
    <property name="idFormat" value="jb.ide.%s[%s]"/>
    <property name="groupName" value="IDE Plugins (users)"/>
  </bean>

  <bean id="webPagesUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.WebPagesUsageStatisticsProvider">
    <property name="configFilePath" value="config/webPagePatterns.txt"/>
    <property name="idFormat" value="jb.web.%s[%s]"/>
    <property name="groupName" value="Web Pages Usage (users)"/>
  </bean>

  <bean id="muteUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.MuteUsageStatisticsProvider">
    <property name="idFormat" value="jb.mute.%s.%s"/>
    <property name="groupName" value="Investigation / Mute"/>
  </bean>

  <bean id="investigationUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.InvestigationUsageStatisticsProvider">
    <property name="idFormat" value="jb.investigation.%s.%s"/>
    <property name="groupName" value="Investigation / Mute"/>
  </bean>

  <bean id="serverConfigurationUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.ServerConfigurationUsageStatisticsProvider">
    <constructor-arg index="0" ref="dbManager"/>
    <property name="idFormat" value="jb.server.%s"/>
    <property name="groupName" value="Server Configuration"/>
  </bean>

  <bean id="vcsUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.VCSUsageStatisticsProvider">
    <property name="idFormat" value="jb.vcs[%s]"/>
    <property name="groupName" value="VCS Root Types"/>
  </bean>

  <bean id="notificatorUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.NotificatorUsageStatisticsProvider">
    <property name="idFormat" value="jb.notificator[%s]"/>
    <property name="groupName" value="Notificators (users)"/>
  </bean>

  <bean id="runnerUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.RunnerUsageStatisticsProvider">
    <property name="idFormat" value="jb.runner[%s]"/>
    <property name="groupName" value="Runners (build configurations)"/>
  </bean>

  <bean id="triggerUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.TriggerUsageStatisticsProvider">
    <property name="idFormat" value="jb.trigger[%s]"/>
    <property name="groupName" value="Triggers (build configurations)"/>
  </bean>

  <bean id="agentsJavaUsageStatisticsProvider" class="jetbrains.buildServer.usageStatistics.impl.providers.AgentsJavaUsageStatisticsProvider">
    <property name="parameterName" value="teamcity.agent.jvm.version"/>
    <property name="idFormat" value="jb.agent.java[%s]"/>
    <property name="groupName" value="Agent Java Versions (agents)"/>
  </bean>

</beans>

